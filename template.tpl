___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "DMP Tags - Template",
  "categories": ["CONVERSIONS"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "DMP Global Site and Conversion Tags",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "event_type",
    "displayName": "DMP Event Type",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "global_tag",
        "displayValue": "DMP Global Site Tag"
      },
      {
        "value": "conversion_tag",
        "displayValue": "DMP Conversion Tag"
      }
    ],
    "simpleValueType": true
  },
  {
    "type": "TEXT",
    "name": "wihpid",
    "displayName": "WIHPID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      },
      {
        "paramName": "event_type",
        "paramValue": "global_tag",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "reference_id",
    "displayName": "Booking reference ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "currency",
    "displayName": "Currency",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "amount_with_tax",
    "displayName": "Total amount with Tax",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "checkin",
    "displayName": "Checkin",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "Date format : YYYY-MM-DD",
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "checkout",
    "displayName": "Checkout",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "Date format : YYYY-MM-DD",
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "dmpclid",
    "displayName": "DMP Click ID",
    "simpleValueType": true,
    "enablingConditions": [
      {
        "paramName": "event_type",
        "paramValue": "conversion_tag",
        "type": "EQUALS"
      },
      {
        "paramName": "event_type",
        "paramValue": "global_tag",
        "type": "EQUALS"
      }
    ],
    "help": "Needs to be set only if the wh_token can be caught through the data_layer and not through the URL"
  },
  {
    "type": "TEXT",
    "name": "dmpclid_fragment",
    "displayName": "whToken From URL",
    "simpleValueType": true,
    "defaultValue": "{{wh_token_extract}}"
  },
  {
    "type": "TEXT",
    "name": "wihpid_fragment",
    "displayName": "WIHPID from URL",
    "simpleValueType": true,
    "defaultValue": "{{wihpid_extract}}"
  },
  {
    "type": "TEXT",
    "name": "custom1",
    "displayName": "Page URL",
    "simpleValueType": true,
    "defaultValue": "{{Page URL}}"
  },
  {
    "type": "TEXT",
    "name": "custom2",
    "displayName": "Referrer",
    "simpleValueType": true,
    "defaultValue": "{{Referrer}}"
  },
  {
    "type": "TEXT",
    "name": "custom3",
    "displayName": "Environment Name",
    "simpleValueType": true,
    "defaultValue": "{{Environment Name}}"
  },
  {
    "type": "TEXT",
    "name": "custom4",
    "displayName": "Container ID",
    "simpleValueType": true,
    "defaultValue": "{{Container ID}}"
  },
  {
    "type": "TEXT",
    "name": "custom5",
    "displayName": "Event",
    "simpleValueType": true,
    "defaultValue": "{{Event}}"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const log = require('logToConsole');
const encodeUriComponent = require('encodeUriComponent');
const makeString = require('makeString');
const sendPixel = require('sendPixel');
const queryPermission = require('queryPermission');
const getQueryParameters = require('getQueryParameters');
const getUrl = require('getUrl');
const setCookie = require('setCookie');
const parseUrl = require('parseUrl');
const getCookieValues = require('getCookieValues');
const getReferrerUrl = require('getReferrerUrl');
const getTimestampMillis = require('getTimestampMillis');





log('data =', data);

const sendConfirmationTag = (data) => {
    const wihpid = data.wihpid;
    const reference_id = data.reference_id;
    const currency = data.currency;
    const amount_with_tax = data.amount_with_tax;
    const checkin = data.checkin;
    const checkout = data.checkout;
    const dmpclid = data.dmpclid;
    const dmpclid_fragment = data.dmpclid_fragment;
    const event_type = data.event_type;
    const cookieName = 'wh_dmp_' + wihpid;
    const custom1 = data.custom1;
    const custom2 = data.custom2;
    const custom3 = data.custom3;
    const custom4 = data.custom4;
    const custom5 = data.custom5;

  

    var pixelUrl = 'https://secure-hotel-tracker.com/wh/conv_gt/?';

    if (wihpid) {

        log('wihpid =', wihpid);
        pixelUrl += 'wihpid=' + encodeUriComponent(makeString(wihpid));
    } else {
        log('wihpid = undefined');
    }

    if (reference_id) {
        log('reference_id =', reference_id);
        pixelUrl += '&reference_id=' + encodeUriComponent(makeString(reference_id));

    } else {
        log('reference_id = undefined');
    }

    if (currency) {
        log('currency =', currency);
        pixelUrl += '&currency=' + encodeUriComponent(makeString(currency));

    } else {
        log('currency = undefined');
    }

    if (amount_with_tax) {
        log('amount_with_tax =', amount_with_tax);
        pixelUrl += '&amount_with_tax=' + encodeUriComponent(makeString(amount_with_tax));

    } else {
        log('amount_with_tax = undefined');
    }

    if (checkin) {
        log('checkin =', checkin);
        pixelUrl += '&checkin=' + encodeUriComponent(makeString(checkin));

    } else {
        log('checkin = undefined');
    }

    if (checkout) {
        log('checkout =', checkout);
        pixelUrl += '&checkout=' + encodeUriComponent(makeString(checkout));

    } else {
        log('checkout = undefined');
    }

    pixelUrl += '&idbe=3&date_format=YYYY-MM-DD';


    if (queryPermission('get_cookies', cookieName)) {
        const cookie_values = getCookieValues(cookieName);
        log('cookie_values =', cookie_values);
        pixelUrl += '&whtoken_c=' + cookie_values;
    } else {
        log('cookies_values = undefined', cookieName);

    }

    if (queryPermission('get_url')) {
        const current_url = getUrl('all');
        log('current_url =', current_url);
        pixelUrl += '&current_url=' + encodeUriComponent(makeString(current_url));
    } else {
        log('current_url = not readable');
    }




    if (queryPermission('get_referrer', 'host') && (queryPermission('get_referrer', 'path')) && (queryPermission('get_referrer', 'query'))) {
        const referrer_all = getReferrerUrl('host') + getReferrerUrl('path') + "?" + getReferrerUrl('query');

        log('referrer_all =', referrer_all);
        pixelUrl += '&referrer_all=' + encodeUriComponent(makeString(referrer_all));
    } else {
        log('referrer_all = not readable');
        if (queryPermission('get_referrer', 'query')) {
            const referrer_query = getReferrerUrl('query');
            log('referrer_query =', referrer_query);
            pixelUrl += '&referrer_query=' + encodeUriComponent(makeString(referrer_query));

        } else {
            log('referrer_params = not readable');
        }


        if (queryPermission('get_referrer', 'path')) {
            const referrer_path = getReferrerUrl('path');
            log('referrer_path =', referrer_path);
            pixelUrl += '&referrer_path=' + encodeUriComponent(makeString(referrer_path));

        } else {
            log('referrer_path = not readable');
        }

        if (queryPermission('get_referrer', 'host')) {
            const referrer_host = getReferrerUrl('host');
            log('referrer_host =', referrer_host);
            pixelUrl += '&referrer_host=' + encodeUriComponent(makeString(referrer_host));

        } else {
            log('referrer_host = not readable');
        }

    }

    if (dmpclid) {
        log('dmpclid =', dmpclid);
        pixelUrl += '&dmpclid=' + encodeUriComponent(makeString(dmpclid));
    } else {
        log('dmpclid = not readable');
    }
  
    if (dmpclid_fragment) {
        log('dmpclid_fragment =', dmpclid_fragment);
        pixelUrl += '&dmpclid_fragment=' + encodeUriComponent(makeString(dmpclid_fragment));
    } else {
        log('dmpclid_fragment = not readable');
    }

    if (custom1) {
        log('custom1 =', custom1);
        pixelUrl += '&custom1=' + encodeUriComponent(makeString(custom1));
    } else {
        log('custom1 = not readable');
    }

    if (custom2) {
        log('custom2 =', custom2);
        pixelUrl += '&custom2=' + encodeUriComponent(makeString(custom2));
    } else {
        log('custom2 = not readable');
    }

    if (custom3) {
        log('custom3 =', custom3);
        pixelUrl += '&custom3=' + encodeUriComponent(makeString(custom3));
    } else {
        log('custom3 = not readable');
    }

    if (custom4) {
        log('custom4 =', custom4);
        pixelUrl += '&custom4=' + encodeUriComponent(makeString(custom4));
    } else {
        log('custom4 = not readable');
    }

    if (custom5) {
        log('custom5 =', custom5);
        pixelUrl += '&custom5=' + encodeUriComponent(makeString(custom5));
    } else {
        log('custom5 = not readable');
    }
    // Call data.gtmOnSuccess when the tag is finished.



    if (queryPermission('send_pixel', pixelUrl)) {
        sendPixel(pixelUrl, data.gtmOnSuccess, data.gtmOnFailure);
        log('send_pixel=', pixelUrl);

    } else {
        log('send_pixel = not readable', pixelUrl);

    }

};

const sendTagCatcher = (data) => {
    const wihpid_TagCatcher = data.wihpid;
    let dmpclid_fragment = data.dmpclid_fragment;
    let wihpid_fragment = data.wihpid_fragment;
  
  
    let wh_token = '';
    if (queryPermission('get_url', 'query', 'wh_token')) {
        wh_token = getQueryParameters('wh_token');
    }
    if (wh_token != undefined && wh_token != '' && wihpid_TagCatcher != undefined && wihpid_TagCatcher != '') {
      let cookieName_TagCatcher = 'wh_dmp_' + wihpid_TagCatcher;
      const options = {
            'domain': getUrl('host'),
            'path': '/',
            'max-age': 30 * 24 * 60 * 60
        };
        log('set cookie permission = ' + queryPermission('set_cookies', cookieName_TagCatcher, options));
        if (queryPermission('set_cookies', cookieName_TagCatcher, options)) {
            setCookie(cookieName_TagCatcher, wh_token, options);
            log('set cookie successfully.', wh_token);
        }
    }else{
      if (dmpclid_fragment != undefined && dmpclid_fragment != '' && wihpid_fragment != undefined && wihpid_fragment != ''){
        let cookieName_fragment = 'wh_dmp_' + wihpid_fragment;
        let options_fragment = {
            'domain': getUrl('host'),
            'path': '/',
            'max-age': 30 * 24 * 60 * 60
        };
        log('set cookie permission = ' + queryPermission('set_cookies', cookieName_fragment, options_fragment));
         if (queryPermission('set_cookies', cookieName_fragment, options_fragment)) {
            setCookie(cookieName_fragment, dmpclid_fragment, options_fragment);
            log('dmpclid_fragment successfully.', dmpclid_fragment);
         }
      }
    }

};
const sendHeartbeat = (data) => {
    const wihp_debug = data.wihpid;
    const reference_id_debug = data.reference_id;
    const currency_debug = data.currency;
    const amount_with_tax_debug = data.amount_with_tax;
    const checkin_debug = data.checkin;
    const checkout_debug = data.checkout;
    const dmpclid_debug = data.dmpclid;
    const dmpclid_fragment_debug = data.dmpclid_fragment;
    const event_type_debug = data.event_type;
    const cookieName_debug = 'wh_dmp_' + wihp_debug;
    const custom1_debug = data.custom1;
    const custom2_debug = data.custom2;
    const custom3_debug = data.custom3;
    const custom4_debug = data.custom4;
    const custom5_debug = data.custom5;
    let wihpid_fragment = data.wihpid_fragment;

  
    var pixelUrl_debug = 'https://p.relay-t.io/beat.gif?';

    if (wihp_debug) {

        log('wihp_debug =', wihp_debug);
        pixelUrl_debug += 'wihp_debug=' + encodeUriComponent(makeString(wihp_debug));
    } else {
        log('wihp_debug = undefined');
    }

    if (reference_id_debug) {
        log('reference_id_debug =', reference_id_debug);
        pixelUrl_debug += '&reference_id_debug=' + encodeUriComponent(makeString(reference_id_debug));

    } else {
        log('reference_id_debug = undefined');
    }

    if (currency_debug) {
        log('currency_debug =', currency_debug);
        pixelUrl_debug += '&currency_debug=' + encodeUriComponent(makeString(currency_debug));

    } else {
        log('currency_debug = undefined');
    }

    if (amount_with_tax_debug) {
        log('amount_with_tax_debug =', amount_with_tax_debug);
        pixelUrl_debug += '&amount_with_tax_debug=' + encodeUriComponent(makeString(amount_with_tax_debug));

    } else {
        log('amount_with_tax_debug = undefined');
    }

    if (checkin_debug) {
        log('checkin_debug =', checkin_debug);
        pixelUrl_debug += '&checkin_debug=' + encodeUriComponent(makeString(checkin_debug));

    } else {
        log('checkin_debug = undefined');
    }

    if (checkout_debug) {
        log('checkout_debug =', checkout_debug);
        pixelUrl_debug += '&checkout_debug=' + encodeUriComponent(makeString(checkout_debug));

    } else {
        log('checkout_debug = undefined');
    }

    pixelUrl_debug += '&idbe=3&date_format=YYYY-MM-DD';


    if (queryPermission('get_cookies', cookieName_debug)) {
        const cookie_values_debug = getCookieValues(cookieName_debug);
        log('cookie_values_debug =', cookie_values_debug);
        pixelUrl_debug += '&whtoken_c_debug=' + cookie_values_debug;
    } else {
        log('cookie_values_debug = undefined', cookieName_debug);

    }

    if (queryPermission('get_url')) {
        const current_url_debug = getUrl('all');
        log('current_url_debug =', current_url_debug);
        pixelUrl_debug += '&current_url_debug=' + encodeUriComponent(makeString(current_url_debug));
    } else {
        log('current_url_debug = not readable');
    }




    if (queryPermission('get_referrer', 'host') && (queryPermission('get_referrer', 'path')) && (queryPermission('get_referrer', 'query'))) {
        const referrer_all_debug = getReferrerUrl('host') + getReferrerUrl('path') + "?" + getReferrerUrl('query');

        log('referrer_all_debug =', referrer_all_debug);
        pixelUrl_debug += '&referrer_all_debug=' + encodeUriComponent(makeString(referrer_all_debug));
    } else {
        log('referrer_all_debug = not readable');
        if (queryPermission('get_referrer', 'query')) {
            const referrer_query_debug = getReferrerUrl('query');
            log('referrer_query_debug =', referrer_query_debug);
            pixelUrl_debug += '&referrer_query_debug=' + encodeUriComponent(makeString(referrer_query_debug));

        } else {
            log('referrer_params_debug = not readable');
        }


        if (queryPermission('get_referrer', 'path')) {
            const referrer_path_debug = getReferrerUrl('path');
            log('referrer_path_debug =', referrer_path_debug);
            pixelUrl_debug += '&referrer_path_debug=' + encodeUriComponent(makeString(referrer_path_debug));

        } else {
            log('referrer_path_debug = not readable');
        }

        if (queryPermission('get_referrer', 'host')) {
            const referrer_host_debug = getReferrerUrl('host');
            log('referrer_host_debug =', referrer_host_debug);
            pixelUrl_debug += '&referrer_host_debug=' + encodeUriComponent(makeString(referrer_host_debug));

        } else {
            log('referrer_host_debug = not readable');
        }

    }

    if (dmpclid_debug) {
        log('dmpclid_debug =', dmpclid_debug);
        pixelUrl_debug += '&dmpclid_debug=' + encodeUriComponent(makeString(dmpclid_debug));
    } else {
        log('dmpclid_debug = not readable');
    }

    if (event_type_debug) {
        log('event_type_debug =', event_type_debug);
        pixelUrl_debug += '&event_type_debug=' + encodeUriComponent(makeString(event_type_debug));
    } else {
        log('event_type_debug = not readable');
    }
  
    if (dmpclid_fragment_debug) {
        log('dmpclid_fragment_debug =', dmpclid_fragment_debug);
        pixelUrl_debug += '&dmpclid_fragment_debug=' + encodeUriComponent(makeString(dmpclid_fragment_debug));
    } else {
        log('dmpclid_fragment_debug = not readable');
    }

    if (custom1_debug) {
        log('custom1_debug =', custom1_debug);
        pixelUrl_debug += '&custom1_debug=' + encodeUriComponent(makeString(custom1_debug));
    } else {
        log('custom1_debug = not readable');
    }

    if (custom2_debug) {
        log('custom2_debug =', custom2_debug);
        pixelUrl_debug += '&custom2_debug=' + encodeUriComponent(makeString(custom2_debug));
    } else {
        log('custom2_debug = not readable');
    }

    if (custom3_debug) {
        log('custom3_debug =', custom3_debug);
        pixelUrl_debug += '&custom3_debug=' + encodeUriComponent(makeString(custom3_debug));
    } else {
        log('custom3_debug = not readable');
    }
  
    if (custom4_debug) {
        log('custom4_debug =', custom4_debug);
        pixelUrl_debug += '&custom4_debug=' + encodeUriComponent(makeString(custom4_debug));
    } else {
        log('custom4_debug = not readable');
    }
  
    if (custom5_debug) {
        log('custom5_debug =', custom5_debug);
        pixelUrl_debug += '&custom5_debug=' + encodeUriComponent(makeString(custom5_debug));
    } else {
        log('custom5_debug = not readable');
    }
  
    if (wihpid_fragment) {
        log('wihpid_fragment =', wihpid_fragment);
        pixelUrl_debug += '&wihpid_fragment=' + encodeUriComponent(makeString(wihpid_fragment));
    } else {
        log('wihpid_fragment = not readable');
    }
    // Call data.gtmOnSuccess when the tag is finished.

    pixelUrl_debug += '&dmp_date_debug=' + encodeUriComponent(makeString(getTimestampMillis()));


    if (queryPermission('send_pixel', pixelUrl_debug)) {
        sendPixel(pixelUrl_debug, data.gtmOnSuccess, data.gtmOnFailure);
        log('send_pixel_debug=', pixelUrl_debug);

    } else {
        log('send_pixel_debug = not readable', pixelUrl_debug);

    }

};

const page_type = data.event_type;

sendTagCatcher(data);

if (page_type.toLowerCase() == 'conversion_tag') {

    sendConfirmationTag(data);

}
sendHeartbeat(data);

data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "path",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "extension",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "query",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "host",
          "value": {
            "type": 8,
            "boolean": true
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 25/04/2024 15:04:36


